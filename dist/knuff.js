(t=>{const e=t.document,o=t.location.href,l=Array.prototype,a=Element.prototype,n=Object.prototype,c={baseUrl:t.location.protocol+"//"+t.location.host+"/",selector:"[data-knuff]",onPop:null,onPush:null},r=t=>{t.state&&u&&c.onPop.call(t,t,t.state.knuff)},s=e=>{const{target:o}=e;if(!1===o.matches(c.selector)||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let l=o.getAttribute("data-knuff")||o.href||!1;l!==t.location.href&&!1!==l&&(e.preventDefault(),l=(t=>t.substr(0,c.baseUrl.length)===c.baseUrl?t:c.baseUrl.replace(/\/*$/,"/")+t.replace(/^\/*/,""))(l),t.history.pushState({knuff:l},null,l),p&&c.onPush.call(e,e,l))};let f=!1,u=!1,p=!1;void 0===a.matches&&(a.matches=a.msMatchesSelector||a.webkitMatchesSelector),t.knuff=(a=>{f||(f=!0,(t=>{"[object Object]"===n.toString.call(t)&&(l.forEach.call(Object.keys(t),e=>{c[e]=t[e]}),"function"==typeof c.onPop&&(u=!0),"function"==typeof c.onPush&&(p=!0))})(a),t.addEventListener("popstate",r),e.addEventListener("click",s),t.history.replaceState({knuff:o},null,o))})})(window);