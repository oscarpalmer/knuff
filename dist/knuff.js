(t=>{const e=t.document,o=t.location.href,l=Element.prototype,n=Object.prototype,a={baseUrl:t.location.protocol+"//"+t.location.host+"/",selector:"[data-knuff]",onPop:null,onPush:null},c=t=>{t.state&&f&&a.onPop.call(t,t,t.state.knuff)},r=e=>{const{target:o}=e;if(!1===o.matches(a.selector)||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let l=o.getAttribute("data-knuff")||o.href||!1;l!==t.location.href&&!1!==l&&(e.preventDefault(),l=(t=>t.substr(0,a.baseUrl.length)===a.baseUrl?t:a.baseUrl.replace(/\/*$/,"/")+t.replace(/^\/*/,""))(l),t.history.pushState({knuff:l},null,l),u&&a.onPush.call(e,e,l))};let s=!1,f=!1,u=!1;void 0===l.matches&&(l.matches=l.msMatchesSelector||l.webkitMatchesSelector),t.knuff=(l=>{s||(s=!0,(t=>{if("[object Object]"===n.toString.call(t)){for(const e in t)n.hasOwnProperty.call(t,e)&&(a[e]=t[e]);"function"==typeof a.onPop&&(f=!0),"function"==typeof a.onPush&&(u=!0)}})(l),t.addEventListener("popstate",c),e.addEventListener("click",r),t.history.replaceState({knuff:o},null,o))})})(window);